-- This script is generated by a tool. Changes may be lost when this script is regenerated.
--*********************************************************************
-- TITLE:         ProcedureOrderAttributeValueDimConfiguration
-- PURPOSE:       To insert configuration data for ProcedureOrderAttributeValueDim and the following custom packages:
--                Procedure Order Attribute Date Load,
--                Procedure Order Attribute String Load
-- DATABASE:      Staging
--*********************************************************************

-- Make sure that Source and Target versions are compatible
DECLARE @iTargetVersion tinyint,
        @iTargetMinorVersion int,
        @iSourceVersion tinyint,
        @iSourceMinorVersion int,
        @VersionCompatible bit,
        @sVersionErrorMessage nvarchar(500)
SET @iSourceVersion = 27
SET @iSourceMinorVersion = 85
SET @iTargetVersion = CAST( Epic.GetConfigurationValue( N'WarehouseVersion' ) AS tinyint )
SET @iTargetMinorVersion = CAST( Epic.GetConfigurationValue( N'WarehouseMinorVersion' ) AS int )
SET @VersionCompatible = CASE WHEN ( @iTargetVersion = @iSourceVersion
                                       AND ( @iTargetMinorVersion >= @iSourceMinorVersion ) )
                                OR ( @iTargetVersion > @iSourceVersion AND @iTargetVersion <= @iSourceVersion + 4 )
                                  THEN 1 ELSE 0 END
IF @VersionCompatible = 0
BEGIN
  SET @sVersionErrorMessage = N'The target version must be within four versions of the source version for this script to be installed. 
The source version is ' + CAST( Epic.GetWarehouseVersionName( @iSourceVersion, @iSourceMinorVersion ) AS nvarchar(50) ) 
+ N', so this script can only be installed on versions ' + CAST( Epic.GetWarehouseVersionName( @iSourceVersion, @iSourceMinorVersion ) AS nvarchar(50) ) 
+ N'+, ' + CAST( Epic.GetWarehouseVersionName( @iSourceVersion + 1, 0 ) AS nvarchar(50)) + N'+, ' + CAST( Epic.GetWarehouseVersionName( @iSourceVersion + 2, 0 ) AS nvarchar(50) ) 
+ N'+, ' + CAST( Epic.GetWarehouseVersionName(@iSourceVersion + 3, 0) AS nvarchar(50)) + N'+, and ' + CAST( Epic.GetWarehouseVersionName(@iSourceVersion + 4, 0) AS nvarchar(50)) + N'+.' 
+ N' The current target version is ' + CAST( Epic.GetWarehouseVersionName( @iTargetVersion, @iTargetMinorVersion ) AS nvarchar(50) ) + N'.';
  THROW 50001, @sVersionErrorMessage, 0;
END

--Check that the database being used is staging database
IF DB_NAME() = dbo.GetReportingDatabaseName()
BEGIN
  ;THROW 50001, 'Script cannot be run on the reporting database. Please run on the staging database.', 0; 
END

-- Make sure that all non-recurring jobs that need to be processed are completed
DECLARE @JobExistCheck bit

EXECUTE Epic.CheckJobExistence @i_IgnoreRecurringJobs = 1, @o_Exist = @JobExistCheck OUTPUT
IF @JobExistCheck = 1
BEGIN;
  THROW 50001, N'There are background jobs waiting to be processed. All non-recurring jobs must be processed before executing this script.', 0;
END

-- Make sure no lookups are broken
DECLARE @sBrokenLookups nvarchar(MAX)
EXECUTE Epic.StringAgg
  @i_sSql = N'SELECT <<Lookups.TableEtlName + N''.'' + Lookups.KeyColumnName>>
                FROM Config.Lookups Lookups
                  INNER JOIN Config.TableEtls TableEtls
                    ON Lookups.TableEtlName = TableEtls.TableEtlName
                  INNER JOIN Config.WarehouseTables WarehouseTables
                    ON Lookups.LookupTableName = WarehouseTables.TableName
                WHERE WarehouseTables.TableEtlName = N''ProcedureOrderAttributeValueDim''
                  AND Lookups.LookupType = N''Id''
                    AND TableEtls.Bridge = 1
                ORDER BY Lookups.TableEtlName, Lookups.KeyColumnName',
  @o_sDelimitedString = @sBrokenLookups OUTPUT
IF COALESCE( @sBrokenLookups, N'' ) <> N''
BEGIN
  SET @sBrokenLookups = N'Unable to set the component to snapshot change tracking (Type 2) because this would break the following lookup columns to ProcedureOrderAttributeValueDim: ' + @sBrokenLookups;
  THROW 50001, @sBrokenLookups, 0;
END

-- Check if historical rows will need to be deleted
DECLARE @RemoveHistoricalRows bit
SET @RemoveHistoricalRows = 0

-- Make sure that there are no failed ETL tasks for the DMC
IF EXISTS( SELECT 1 
             FROM Epic.FailedEtlTasks
               WHERE EtlName = N'ProcedureOrderAttributeValueDim'
               AND [Fixed] = 0
           UNION ALL
           SELECT 1
             FROM Epic.EtlPerformanceInfoLog
             WHERE [Level] IN (N'Task', N'Detail')
               AND EtlName = N'ProcedureOrderAttributeValueDim'
               AND EndTime IS NULL )
BEGIN;
  THROW 50001, N'ProcedureOrderAttributeValueDim can''t be deployed because it has a failed ETL task and/or is currently running', 0;
END

-- Make sure that the package sources exist
IF Epic.GetIdForSourceName( N'Clarity' ) IS NULL
BEGIN;
  THROW 50001, N'Package source Clarity doesn''t exist in the target environment', 0;
END

--check for duplicate display names
DECLARE @i_tPackageNamesAndEpicVersions Console.PackageNamesAndEpicVersions
INSERT INTO @i_tPackageNamesAndEpicVersions VALUES 
( N'Procedure_Order_Attribute_Date_Load_X', N'Procedure Order Attribute Date Load', NULL, NULL )
,( N'Procedure_Order_Attribute_String_Load_X', N'Procedure Order Attribute String Load', NULL, NULL )
EXECUTE Console.CheckDisplayNameOverlapPackageLevel N'ProcedureOrderAttributeValueDim', @i_tPackageNamesAndEpicVersions

-- Make sure that the selected packages do not exist in other DMCs
DECLARE @sDmcNameInUse nvarchar(300),
        @sPackageNameInUse nvarchar(300),
        @sPackageErrorMessage nvarchar(MAX)

SET @sPackageErrorMessage = ISNULL( @sPackageErrorMessage, '' ) 
SELECT @sPackageErrorMessage += N'Package ' + Packages.PackageName + N' is in use in DMC ' + Packages.TableEtlName + N'. '
  FROM Config.Packages Packages
  WHERE Packages.TableEtlName <> N'ProcedureOrderAttributeValueDim'
    AND Packages.PackageName IN (N'Procedure_Order_Attribute_Date_Load_X',N'Procedure_Order_Attribute_String_Load_X')
IF @sPackageErrorMessage <> N''
BEGIN;
  THROW 50001, @sPackageErrorMessage, 0;
END

-- Make sure that you can acquire system level lock
DECLARE @SuccessCheck bit,
        @sErrorCheck nvarchar(MAX),
        @sLockedByCheck nvarchar(200)

EXECUTE Epic.LockEtl N'System', 1, @i_sLockedBy = N'Console Generated Script', @i_nLoopDelaySeconds = 1, @i_nTimeoutSeconds = 0, 
  @o_IsSuccess = @SuccessCheck OUTPUT, @o_sCurrentlyLockedBy = @sLockedByCheck OUTPUT, @i_IsExecution = 0 
IF @SuccessCheck = 0
BEGIN
  SET @sErrorCheck = CASE WHEN NULLIF(@sLockedByCheck, N'') IS NULL THEN N'Background process' ELSE @sLockedByCheck END
    + N' is currently locking system. Try again later.';
  THROW 50001, @sErrorCheck, 1;
END

SET NOCOUNT ON

DECLARE @sDmcName nvarchar(50),
        @EpicReleased bit,
        @HasDeveloperAccess bit,
        @ScriptType nvarchar(50),
        @sPackageNames nvarchar(max)

SET @sDmcName = N'ProcedureOrderAttributeValueDim'
SET @EpicReleased = 0
SET @HasDeveloperAccess = 1
SET @ScriptType = N'Dmc&Package'
SET @sPackageNames = N'Procedure_Order_Attribute_Date_Load_X,Procedure_Order_Attribute_String_Load_X'

BEGIN TRY

  EXECUTE Console.PreDmcScript @sDmcName, @EpicReleased, @HasDeveloperAccess, @ScriptType

  EXECUTE Console.PreInsertIntoEtlDependencies @sDmcName, @EpicReleased, @ScriptType, @sPackageNames

  -- Insert into EtlDependencies
  EXECUTE Console.InsertIntoEtlDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sDependentObjectName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sDependentObjectType = N'Package',
    @i_sDependencyTableEtlName = N'AttributeDim',
    @i_sDependencyObjectName = N'AttributeDim',
    @i_sDependencyObjectType = N'Component',
    @i_sDependencyType = N'Load',
    @i_EpicReleased = 0,
    @i_InheritedFromParentDmc = 0

  EXECUTE Console.InsertIntoEtlDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sDependentObjectName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sDependentObjectType = N'Package',
    @i_sDependencyTableEtlName = N'ProcedureOrderFact',
    @i_sDependencyObjectName = N'ProcedureOrderFact',
    @i_sDependencyObjectType = N'Component',
    @i_sDependencyType = N'Load',
    @i_EpicReleased = 0,
    @i_InheritedFromParentDmc = 0

  EXECUTE Console.InsertIntoEtlDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sDependentObjectName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sDependentObjectType = N'Package',
    @i_sDependencyTableEtlName = N'AttributeDim',
    @i_sDependencyObjectName = N'AttributeDim',
    @i_sDependencyObjectType = N'Component',
    @i_sDependencyType = N'Load',
    @i_EpicReleased = 0,
    @i_InheritedFromParentDmc = 0

  EXECUTE Console.InsertIntoEtlDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sDependentObjectName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sDependentObjectType = N'Package',
    @i_sDependencyTableEtlName = N'ProcedureOrderFact',
    @i_sDependencyObjectName = N'ProcedureOrderFact',
    @i_sDependencyObjectType = N'Component',
    @i_sDependencyType = N'Load',
    @i_EpicReleased = 0,
    @i_InheritedFromParentDmc = 0

  EXECUTE Console.PostInsertIntoEtlDependencies @sDmcName, @EpicReleased

  EXECUTE Console.PreInsertIntoLookups @sDmcName, @EpicReleased

  -- Insert into Lookups
  --    No data   

  -- Insert into DmcMatching
  --    No data   

  -- Insert into MatchingRules
  --    No data   

  -- Insert into MatchingRuleColumns
  --    No data   

  -- Insert into MatchingRuleColumnExcludedValues
  --    No data   

  EXECUTE Console.PreInsertIntoPackages @i_sDmcName = @sDmcName, @i_EpicReleased = @EpicReleased, @i_sPackageNames = @sPackageNames

  -- Insert into Packages
  EXECUTE Console.InsertIntoPackages
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sDisplayName = N'Procedure Order Attribute Date Load',
    @i_sGroupName = N'Procedure Order Attribute Values',
    @i_sProcedureName = N'',
    @i_sExtractMethod = N'Query',
    @i_sDestinationType = N'Reporting',
    @i_sAction = N'Load',
    @i_SingleUse = 0,
    @i_ExcludeFromNightly = 0,
    @i_ExcludeFromNightlyReleased = 0,
    @i_ExcludeFromNightlyOverride = NULL,
    @i_iProcessIndex = NULL,
    @i_sDescription = N'',
    @i_sClarityFullExtractQuery = N'SELECT CAST(Data.HLV_ID AS numeric(18,0)) NUMERICBASEID,
       CAST(Value.LINE AS varchar(20)) LINE,
       CAST(ORDER_PROC.ORDER_PROC_ID AS varchar(50)) PROCEDUREID,
       CAST(Data.ELEMENT_ID AS varchar(50)) ATTRIBUTEID,
       Data.CUR_VALUE_DATETIME INSTANT,
       CAST(Value.SMRTDTA_ELEM_VALUE AS varchar(300)) VALUE,
       SmartDataElement.DATA_TYPE_C DATATYPE
FROM SMRTDTA_ELEM_DATA Data
  INNER JOIN SMRTDTA_ELEM_VALUE Value
    ON Data.HLV_ID = Value.HLV_ID
  INNER JOIN CLARITY_CONCEPT SmartDataElement
    ON Data.ELEMENT_ID = SmartDataElement.CONCEPT_ID
       AND SmartDataElement.DATA_TYPE_C IN ( 3, 4, 11 )
  INNER JOIN ORDER_PROC
    ON ORDER_PROC.ORDER_PROC_ID = Data.RECORD_ID_NUMERIC
WHERE Data.CONTEXT_NAME = ''ORDER''
        AND Data.HLV_ID > <<LowerBound>>
        AND Data.HLV_ID <= <<UpperBound>>',
    @i_sClarityOracleFullExtractQuery = N'',
    @i_sClarityIncrementalExtractQuery = N'SELECT CAST(Data.HLV_ID AS numeric(18,0)) NUMERICBASEID,
       CAST(Value.LINE AS varchar(20)) LINE,
       CAST(ORDER_PROC.ORDER_PROC_ID AS varchar(50)) PROCEDUREID,
       CAST(Data.ELEMENT_ID AS varchar(50)) ATTRIBUTEID,
       Data.CUR_VALUE_DATETIME INSTANT,
       CAST(Value.SMRTDTA_ELEM_VALUE AS varchar(300)) VALUE,
       SmartDataElement.DATA_TYPE_C DATATYPE
FROM SMRTDTA_ELEM_DATA Data
  INNER JOIN <<WarehouseUniqueChangesTableName>> Filter
    ON Filter.BASE_ID = Data.HLV_ID
  INNER JOIN SMRTDTA_ELEM_VALUE Value
    ON Data.HLV_ID = Value.HLV_ID
  INNER JOIN CLARITY_CONCEPT SmartDataElement
    ON Data.ELEMENT_ID = SmartDataElement.CONCEPT_ID
       AND SmartDataElement.DATA_TYPE_C IN ( 3, 4, 11 )
  INNER JOIN ORDER_PROC
    ON ORDER_PROC.ORDER_PROC_ID = Data.RECORD_ID_NUMERIC
WHERE Data.CONTEXT_NAME = ''ORDER''',
    @i_sClarityOracleIncrementalExtractQuery = N'',
    @i_sClarityBackfillDeleteExtractQuery = N'',
    @i_sClarityOracleBackfillDeleteExtractQuery = N'',
    @i_iFirstEpicVersionId = 96,
    @i_iLastEpicVersionId = 32767,
    @i_sClarityBackfillThreshold = N'',
    @i_sClarityIncrementalThreshold = N'',
    @i_sRandomSampleSize = N'',
    @i_sRandomSampleThreshold = N'',
    @i_EpicReleased = 0,
    @i_EtlLeadOwned = 0,
    @i_sLineageProcedureName = N'',
    @i_NeedsClarityValidation = 0,
    @i_ExecuteIn32BitMode = NULL,
    @i_sCatalogLocation = N'',
    @i_IsTargetingPackageSpecificImportTable = 0,
    @i_SupportsMultipleClarityVersions = 0,
    @i_ClarityFullExtractQueryBatchMode = 0,
    @i_ClarityIncrementalExtractQueryBatchMode = 0,
    @i_IgnoreStringIdTypesDuringLoad = 0,
    @i_PerformsReverseBusinessKeyLookups = 0,
    @i_RecoverOnFailure = 1,
    @i_sClarityUniqueTableOverrideCode = N'',
    @i_sClarityOracleUniqueTableOverrideCode = N''

  EXECUTE Console.InsertIntoPackages
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sDisplayName = N'Procedure Order Attribute String Load',
    @i_sGroupName = N'Procedure Order Attribute Values',
    @i_sProcedureName = N'',
    @i_sExtractMethod = N'Query',
    @i_sDestinationType = N'Reporting',
    @i_sAction = N'Load',
    @i_SingleUse = 0,
    @i_ExcludeFromNightly = 0,
    @i_ExcludeFromNightlyReleased = 0,
    @i_ExcludeFromNightlyOverride = NULL,
    @i_iProcessIndex = NULL,
    @i_sDescription = N'Loads string values for procedure order smart data elements.',
    @i_sClarityFullExtractQuery = N'SELECT CAST(Data.HLV_ID AS numeric(18,0)) NUMERICBASEID,
       CAST(Value.LINE AS varchar(20)) LINE,
       CAST(ORDER_PROC.ORDER_PROC_ID AS varchar(50)) PROCEDUREID,
       CAST(Data.ELEMENT_ID AS varchar(50)) ATTRIBUTEID,
       Data.CUR_VALUE_DATETIME INSTANT,
       CASE WHEN SmartDataElement.DATA_TYPE_C = 7
                   AND NULLIF( SmartDataElement.MASTER_FILE_LINK, '''''''' ) IS NOT NULL
                   AND NULLIF( SmartDataElement.MASTER_FILE_ITEM, 0.1 ) IS NOT NULL
                   AND LEN( Value.SMRTDTA_ELEM_VALUE ) <= 27         
              THEN SmartDataElement.MASTER_FILE_LINK
            ELSE NULL END CAT_INI,
CASE WHEN SmartDataElement.DATA_TYPE_C = 7
                   AND NULLIF( SmartDataElement.MASTER_FILE_LINK, '''''''' ) IS NOT NULL
                   AND NULLIF( SmartDataElement.MASTER_FILE_ITEM, 0.1 ) IS NOT NULL
                   AND LEN( Value.SMRTDTA_ELEM_VALUE ) <= 27
              THEN CAST( SmartDataElement.MASTER_FILE_ITEM AS numeric(18,0) )
            ELSE NULL END CAT_ITEM,
       CAST(Value.SMRTDTA_ELEM_VALUE AS varchar(300)) VALUE
FROM SMRTDTA_ELEM_DATA Data
  INNER JOIN SMRTDTA_ELEM_VALUE Value
    ON Data.HLV_ID = Value.HLV_ID
  INNER JOIN CLARITY_CONCEPT SmartDataElement
    ON Data.ELEMENT_ID = SmartDataElement.CONCEPT_ID
       AND SmartDataElement.DATA_TYPE_C NOT IN ( 3, 4, 8, 9, 11, 12 )
  INNER JOIN ORDER_PROC
    ON ORDER_PROC.ORDER_PROC_ID = Data.RECORD_ID_NUMERIC
WHERE Data.CONTEXT_NAME = ''ORDER''
        AND Data.HLV_ID > <<LowerBound>>
        AND Data.HLV_ID <= <<UpperBound>>',
    @i_sClarityOracleFullExtractQuery = N'',
    @i_sClarityIncrementalExtractQuery = N'SELECT CAST(Data.HLV_ID AS numeric(18,0)) NUMERICBASEID,
       CAST(Value.LINE AS varchar(20)) LINE,
       CAST(ORDER_PROC.ORDER_PROC_ID AS VARCHAR(50)) PROCEDUREID,
       CAST(Data.ELEMENT_ID AS varchar(50)) ATTRIBUTEID,
       Data.CUR_VALUE_DATETIME INSTANT,
       CASE WHEN SmartDataElement.DATA_TYPE_C = 7
                   AND NULLIF( SmartDataElement.MASTER_FILE_LINK, '''''''' ) IS NOT NULL
                   AND NULLIF( SmartDataElement.MASTER_FILE_ITEM, 0.1 ) IS NOT NULL
                   AND LEN( Value.SMRTDTA_ELEM_VALUE ) <= 27
              THEN SmartDataElement.MASTER_FILE_LINK
            ELSE NULL END CAT_INI,
       CASE WHEN SmartDataElement.DATA_TYPE_C = 7
 AND NULLIF( SmartDataElement.MASTER_FILE_LINK, '''''''' ) IS NOT NULL
                   AND NULLIF( SmartDataElement.MASTER_FILE_ITEM, 0.1 ) IS NOT NULL
                   AND LEN( Value.SMRTDTA_ELEM_VALUE ) <= 27
              THEN CAST( SmartDataElement.MASTER_FILE_ITEM AS numeric(18,0) )
            ELSE NULL END CAT_ITEM,
       CAST(Value.SMRTDTA_ELEM_VALUE AS varchar(300)) VALUE
FROM SMRTDTA_ELEM_DATA Data
  INNER JOIN <<WarehouseUniqueChangesTableName>> Filter
    ON Filter.BASE_ID = Data.HLV_ID
  INNER JOIN SMRTDTA_ELEM_VALUE Value
    ON Data.HLV_ID = Value.HLV_ID
  INNER JOIN CLARITY_CONCEPT SmartDataElement
    ON Data.ELEMENT_ID = SmartDataElement.CONCEPT_ID
       AND SmartDataElement.DATA_TYPE_C NOT IN ( 3, 4, 8, 9, 11, 12 )
   INNER JOIN ORDER_PROC
    ON ORDER_PROC.ORDER_PROC_ID = Data.RECORD_ID_NUMERIC
WHERE Data.CONTEXT_NAME = ''ORDER''',
    @i_sClarityOracleIncrementalExtractQuery = N'',
    @i_sClarityBackfillDeleteExtractQuery = N'',
    @i_sClarityOracleBackfillDeleteExtractQuery = N'',
    @i_iFirstEpicVersionId = 96,
    @i_iLastEpicVersionId = 32767,
    @i_sClarityBackfillThreshold = N'',
    @i_sClarityIncrementalThreshold = N'',
    @i_sRandomSampleSize = N'',
    @i_sRandomSampleThreshold = N'',
    @i_EpicReleased = 0,
    @i_EtlLeadOwned = 0,
    @i_sLineageProcedureName = N'',
    @i_NeedsClarityValidation = 0,
    @i_ExecuteIn32BitMode = NULL,
    @i_sCatalogLocation = N'',
    @i_IsTargetingPackageSpecificImportTable = 0,
    @i_SupportsMultipleClarityVersions = 0,
    @i_ClarityFullExtractQueryBatchMode = 0,
    @i_ClarityIncrementalExtractQueryBatchMode = 0,
    @i_IgnoreStringIdTypesDuringLoad = 0,
    @i_PerformsReverseBusinessKeyLookups = 0,
    @i_RecoverOnFailure = 1,
    @i_sClarityUniqueTableOverrideCode = N'',
    @i_sClarityOracleUniqueTableOverrideCode = N''

  EXECUTE Console.PreInsertIntoPackageSources @i_EpicReleased = @EpicReleased

  -- Insert into PackageSources
  EXECUTE Console.InsertIntoPackageSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_iSourceId = 1,
    @i_sSourceName = N'Clarity',
    @i_sIdTypeOverride = N'',
    @i_RepeatBackfill = 0,
    @i_RunIncremental = 1

  EXECUTE Console.InsertIntoPackageSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_iSourceId = 1,
    @i_sSourceName = N'Clarity',
    @i_sIdTypeOverride = N'',
    @i_RepeatBackfill = 0,
    @i_RunIncremental = 1

  EXECUTE Console.PostInsertIntoPackageSources @sDmcName

  -- Insert into PackageBaseIdColumns
  EXECUTE Console.InsertIntoPackageBaseIdColumns
    @i_sDmcName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_iPosition = 1,
    @i_sDataType = N'numeric(18,0)',
    @i_sBaseTableName = N'SMRTDTA_ELEM_DATA',
    @i_sBaseIdColumnName = N'HLV_ID',
    @i_AllowChangesToBaseIdDataType = 0

  EXECUTE Console.InsertIntoPackageBaseIdColumns
    @i_sDmcName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_iPosition = 1,
    @i_sDataType = N'numeric(18,0)',
    @i_sBaseTableName = N'SMRTDTA_ELEM_DATA',
    @i_sBaseIdColumnName = N'HLV_ID',
    @i_AllowChangesToBaseIdDataType = 0

  EXECUTE Console.PreInsertIntoPackageCategoryTables @i_EpicReleased = @EpicReleased

  -- Insert into PackageCategoryTables
  --    No data   

  EXECUTE Console.PreInsertIntoPackageClaritySourceColumns @i_EpicReleased = @EpicReleased

  -- Insert into PackageClaritySourceColumns
  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'ATTRIBUTEID',
    @i_sDataType = N'varchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'DATATYPE',
    @i_sDataType = N'int',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'INSTANT',
    @i_sDataType = N'datetime',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'LINE',
    @i_sDataType = N'varchar',
    @i_iStringLength = 20,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'NUMERICBASEID',
    @i_sDataType = N'numeric',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = 18,
    @i_iNumericScale = 0,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'PROCEDUREID',
    @i_sDataType = N'varchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'VALUE',
    @i_sDataType = N'varchar',
    @i_iStringLength = 300,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'ATTRIBUTEID',
    @i_sDataType = N'varchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'CAT_INI',
    @i_sDataType = N'varchar',
    @i_iStringLength = 22,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'CAT_ITEM',
    @i_sDataType = N'numeric',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = 18,
    @i_iNumericScale = 0,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'INSTANT',
    @i_sDataType = N'datetime',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'LINE',
    @i_sDataType = N'varchar',
    @i_iStringLength = 20,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'NUMERICBASEID',
    @i_sDataType = N'numeric',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = 18,
    @i_iNumericScale = 0,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'PROCEDUREID',
    @i_sDataType = N'varchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClaritySourceColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_DeletePackage = 0,
    @i_sSourceColumnName = N'VALUE',
    @i_sDataType = N'varchar',
    @i_iStringLength = 300,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_EpicReleased = 0

  EXECUTE Console.PreInsertIntoPackageClarityTables @i_EpicReleased = @EpicReleased

  -- Insert into PackageClarityTables
  EXECUTE Console.InsertIntoPackageClarityTables
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sClarityTableName = N'CLARITY_CONCEPT',
    @i_sDataChangesInsertQuery = NULL,
    @i_sOracleDataChangesInsertQuery = NULL,
    @i_sDeletesInsertQuery = NULL,
    @i_sOracleDeletesInsertQuery = NULL,
    @i_CanBeExtended = 0,
    @i_sInsertQueryExtension = N'',
    @i_ThinClarityEnabled = 0,
    @i_BaseIdColumnName = NULL,
    @i_IncludeId = 0,
    @i_DataChangesInsertQueryBatchMode = 0,
    @i_DeletesInsertQueryBatchMode = 0,
    @i_IsIncludedInDataLineage = 1,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClarityTables
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sClarityTableName = N'ORDER_PROC',
    @i_sDataChangesInsertQuery = NULL,
    @i_sOracleDataChangesInsertQuery = NULL,
    @i_sDeletesInsertQuery = NULL,
    @i_sOracleDeletesInsertQuery = NULL,
    @i_CanBeExtended = 0,
    @i_sInsertQueryExtension = N'',
    @i_ThinClarityEnabled = 0,
    @i_BaseIdColumnName = NULL,
    @i_IncludeId = 0,
    @i_DataChangesInsertQueryBatchMode = 0,
    @i_DeletesInsertQueryBatchMode = 0,
    @i_IsIncludedInDataLineage = 1,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClarityTables
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sClarityTableName = N'SMRTDTA_ELEM_DATA',
    @i_sDataChangesInsertQuery = N'Select distinct changes.hlv_id from  <<TempTable>> Changes ',
    @i_sOracleDataChangesInsertQuery = NULL,
    @i_sDeletesInsertQuery = NULL,
    @i_sOracleDeletesInsertQuery = NULL,
    @i_CanBeExtended = 0,
    @i_sInsertQueryExtension = N'',
    @i_ThinClarityEnabled = 0,
    @i_BaseIdColumnName = NULL,
    @i_IncludeId = 0,
    @i_DataChangesInsertQueryBatchMode = 0,
    @i_DeletesInsertQueryBatchMode = 0,
    @i_IsIncludedInDataLineage = 1,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClarityTables
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sClarityTableName = N'SMRTDTA_ELEM_VALUE',
    @i_sDataChangesInsertQuery = N'Select distinct changes.hlv_id from  <<TempTable>> Changes ',
    @i_sOracleDataChangesInsertQuery = NULL,
    @i_sDeletesInsertQuery = NULL,
    @i_sOracleDeletesInsertQuery = NULL,
    @i_CanBeExtended = 0,
    @i_sInsertQueryExtension = N'',
    @i_ThinClarityEnabled = 0,
    @i_BaseIdColumnName = NULL,
    @i_IncludeId = 0,
    @i_DataChangesInsertQueryBatchMode = 0,
    @i_DeletesInsertQueryBatchMode = 0,
    @i_IsIncludedInDataLineage = 1,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClarityTables
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sClarityTableName = N'CLARITY_CONCEPT',
    @i_sDataChangesInsertQuery = NULL,
    @i_sOracleDataChangesInsertQuery = NULL,
    @i_sDeletesInsertQuery = NULL,
    @i_sOracleDeletesInsertQuery = NULL,
    @i_CanBeExtended = 0,
    @i_sInsertQueryExtension = N'',
    @i_ThinClarityEnabled = 0,
    @i_BaseIdColumnName = NULL,
    @i_IncludeId = 0,
    @i_DataChangesInsertQueryBatchMode = 0,
    @i_DeletesInsertQueryBatchMode = 0,
    @i_IsIncludedInDataLineage = 1,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClarityTables
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sClarityTableName = N'ORDER_PROC',
    @i_sDataChangesInsertQuery = NULL,
    @i_sOracleDataChangesInsertQuery = NULL,
    @i_sDeletesInsertQuery = NULL,
    @i_sOracleDeletesInsertQuery = NULL,
    @i_CanBeExtended = 0,
    @i_sInsertQueryExtension = N'',
    @i_ThinClarityEnabled = 0,
    @i_BaseIdColumnName = NULL,
    @i_IncludeId = 0,
    @i_DataChangesInsertQueryBatchMode = 0,
    @i_DeletesInsertQueryBatchMode = 0,
    @i_IsIncludedInDataLineage = 1,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClarityTables
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sClarityTableName = N'SMRTDTA_ELEM_DATA',
    @i_sDataChangesInsertQuery = N'Select distinct changes.hlv_id from  <<TempTable>> Changes ',
    @i_sOracleDataChangesInsertQuery = NULL,
    @i_sDeletesInsertQuery = NULL,
    @i_sOracleDeletesInsertQuery = NULL,
    @i_CanBeExtended = 0,
    @i_sInsertQueryExtension = N'',
    @i_ThinClarityEnabled = 0,
    @i_BaseIdColumnName = NULL,
    @i_IncludeId = 0,
    @i_DataChangesInsertQueryBatchMode = 0,
    @i_DeletesInsertQueryBatchMode = 0,
    @i_IsIncludedInDataLineage = 1,
    @i_EpicReleased = 0

  EXECUTE Console.InsertIntoPackageClarityTables
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sClarityTableName = N'SMRTDTA_ELEM_VALUE',
    @i_sDataChangesInsertQuery = N'Select distinct changes.hlv_id from  <<TempTable>> Changes ',
    @i_sOracleDataChangesInsertQuery = NULL,
    @i_sDeletesInsertQuery = NULL,
    @i_sOracleDeletesInsertQuery = NULL,
    @i_CanBeExtended = 0,
    @i_sInsertQueryExtension = N'',
    @i_ThinClarityEnabled = 0,
    @i_BaseIdColumnName = NULL,
    @i_IncludeId = 0,
    @i_DataChangesInsertQueryBatchMode = 0,
    @i_DeletesInsertQueryBatchMode = 0,
    @i_IsIncludedInDataLineage = 1,
    @i_EpicReleased = 0

  EXECUTE Console.PostInsertIntoPackageClarityTables

  EXECUTE Console.PreInsertIntoPackageColumns @EpicReleased

  -- Insert into PackageColumns
  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'_IsIncremental',
    @i_sDescription = N'If the incremental version of the package loaded this row then "1"
Otherwise "0"',
    @i_sExpression = N'@[User::IsIncremental]',
    @i_IgnoreError = 1,
    @i_sDataType = N'bit',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'_LoadId',
    @i_sDescription = N'The ID of the load attempt',
    @i_sExpression = N'@[User::LoadId]',
    @i_IgnoreError = 1,
    @i_sDataType = N'tinyint',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'_PackageId',
    @i_sDescription = N'"2"',
    @i_sExpression = N'2',
    @i_IgnoreError = 1,
    @i_sDataType = N'smallint',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'_SourceId',
    @i_sDescription = N'"1"',
    @i_sExpression = N'1',
    @i_IgnoreError = 1,
    @i_sDataType = N'int',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'AttributeId',
    @i_sDescription = NULL,
    @i_sExpression = N' [ATTRIBUTEID] ',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'AttributeIdType',
    @i_sDescription = NULL,
    @i_sExpression = N' "EpicSmartDataId" ',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'AttributeIdTypeId',
    @i_sDescription = NULL,
    @i_sExpression = NULL,
    @i_IgnoreError = 1,
    @i_sDataType = N'smallint',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'Date',
    @i_sDescription = NULL,
    @i_sExpression = N'(dt_dbdate) [INSTANT] ',
    @i_IgnoreError = 1,
    @i_sDataType = N'date',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = N'Local',
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'DateValue',
    @i_sDescription = NULL,
    @i_sExpression = N' [DATATYPE] ==3 ? (dt_dbdate)[DATEADD]("day",(dt_i4)  [VALUE] , (dt_dbtimestamp)"12/31/1840"): ([DATATYPE]==11 ? (dt_dbdate) [DATEADD]("day", ((dt_i8) [VALUE] - (dt_i8) [VALUE] % 86400) / 86400, (dt_dbtimestamp)"12/31/1840"):NULL(dt_dbdate))',
    @i_IgnoreError = 1,
    @i_sDataType = N'date',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = N'Unknown',
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'Id',
    @i_sDescription = NULL,
    @i_sExpression = N'(dt_wstr,18) [NUMERICBASEID] + "|" +  [LINE] ',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'IdType',
    @i_sDescription = NULL,
    @i_sExpression = N'"EpicConceptValueID|line" ',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'IdTypeId',
    @i_sDescription = NULL,
    @i_sExpression = NULL,
    @i_IgnoreError = 1,
    @i_sDataType = N'smallint',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'NumericBaseId',
    @i_sDescription = NULL,
    @i_sExpression = N' [NUMERICBASEID] ',
    @i_IgnoreError = 1,
    @i_sDataType = N'numeric',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = 18,
    @i_iNumericScale = 0,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'NumericValue',
    @i_sDescription = NULL,
    @i_sExpression = NULL,
    @i_IgnoreError = 1,
    @i_sDataType = N'numeric',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = 18,
    @i_iNumericScale = 2,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'ProcedureOrderId',
    @i_sDescription = NULL,
    @i_sExpression = N' [PROCEDUREID] ',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'ProcedureOrderIdType',
    @i_sDescription = NULL,
    @i_sExpression = N'"EpicOrderId"',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'ProcedureOrderIdTypeId',
    @i_sDescription = NULL,
    @i_sExpression = NULL,
    @i_IgnoreError = 1,
    @i_sDataType = N'smallint',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'StringBaseId',
    @i_sDescription = NULL,
    @i_sExpression = NULL,
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'Value',
    @i_sDescription = NULL,
    @i_sExpression = N' [DATATYPE] ==3 ? NULL(dt_wstr,300):( [DATATYPE] == 4 ? (dt_wstr,300) ((dt_dbtime)[DATEADD]("second",(dt_i4)  [VALUE] , (dt_dbtimestamp)"12/31/1840")):(dt_wstr,300) [DATEADD]("second",(dt_i8)  [VALUE] % 86400,[DATEADD]("day", ((dt_i8) [VALUE] - (dt_i8) [VALUE] % 86400) / 86400, (dt_dbtimestamp)"12/31/1840")))',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 300,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'_IsIncremental',
    @i_sDescription = N'If the incremental version of the package loaded this row then "1"
Otherwise "0"',
    @i_sExpression = N'@[User::IsIncremental]',
    @i_IgnoreError = 1,
    @i_sDataType = N'bit',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'_LoadId',
    @i_sDescription = N'The ID of the load attempt',
    @i_sExpression = N'@[User::LoadId]',
    @i_IgnoreError = 1,
    @i_sDataType = N'tinyint',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'_PackageId',
    @i_sDescription = N'"1"',
    @i_sExpression = N'1',
    @i_IgnoreError = 1,
    @i_sDataType = N'smallint',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'_SourceId',
    @i_sDescription = N'"1"',
    @i_sExpression = N'1',
    @i_IgnoreError = 1,
    @i_sDataType = N'int',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'AttributeId',
    @i_sDescription = NULL,
    @i_sExpression = N' [ATTRIBUTEID] ',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'AttributeIdType',
    @i_sDescription = NULL,
    @i_sExpression = N'"EpicSmartDataID"',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'AttributeIdTypeId',
    @i_sDescription = NULL,
    @i_sExpression = NULL,
    @i_IgnoreError = 1,
    @i_sDataType = N'smallint',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'Date',
    @i_sDescription = NULL,
    @i_sExpression = N'(dt_dbdate) [INSTANT] ',
    @i_IgnoreError = 1,
    @i_sDataType = N'date',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = N'Local',
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'DateValue',
    @i_sDescription = NULL,
    @i_sExpression = NULL,
    @i_IgnoreError = 1,
    @i_sDataType = N'date',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'Id',
    @i_sDescription = NULL,
    @i_sExpression = N'(dt_wstr,18)[NUMERICBASEID] + "|" +  [LINE] ',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'IdType',
    @i_sDescription = NULL,
    @i_sExpression = N' "EpicConceptValueID|line" ',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'IdTypeId',
    @i_sDescription = NULL,
    @i_sExpression = NULL,
    @i_IgnoreError = 1,
    @i_sDataType = N'smallint',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'NumericBaseId',
    @i_sDescription = NULL,
    @i_sExpression = N' [NUMERICBASEID] ',
    @i_IgnoreError = 1,
    @i_sDataType = N'numeric',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = 18,
    @i_iNumericScale = 0,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'NumericValue',
    @i_sDescription = NULL,
    @i_sExpression = N'(dt_numeric,18,2)replace( [VALUE] ,".",((dt_wstr,50)(1.1)=="1,1"?",":"."))',
    @i_IgnoreError = 1,
    @i_sDataType = N'numeric',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = 18,
    @i_iNumericScale = 2,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'ProcedureOrderId',
    @i_sDescription = NULL,
    @i_sExpression = N' [PROCEDUREID] ',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'ProcedureOrderIdType',
    @i_sDescription = NULL,
    @i_sExpression = N'"EpicOrderId"',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'ProcedureOrderIdTypeId',
    @i_sDescription = NULL,
    @i_sExpression = NULL,
    @i_IgnoreError = 1,
    @i_sDataType = N'smallint',
    @i_iStringLength = NULL,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'StringBaseId',
    @i_sDescription = NULL,
    @i_sExpression = NULL,
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 50,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.InsertIntoPackageColumns
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'Value',
    @i_sDescription = NULL,
    @i_sExpression = N' [VALUE] ',
    @i_IgnoreError = 1,
    @i_sDataType = N'nvarchar',
    @i_iStringLength = 300,
    @i_iNumericPrecision = NULL,
    @i_iNumericScale = NULL,
    @i_IsDelete = 0,
    @i_IsValid = 1,
    @i_EpicReleased = 0,
    @i_sClarityTimeZone = NULL,
    @i_sTimeZoneOverride = NULL

  EXECUTE Console.PreInsertIntoPackageAllowedForeignKeyIdTypes

  -- Insert into PackageAllowedForeignKeyIdTypes
  --    No data   

  EXECUTE Console.PostInsertIntoPackageAllowedForeignKeyIdTypes @sDmcName

  EXECUTE Console.PreInsertIntoPackageDataDependencies @i_EpicReleased = @EpicReleased

  -- Insert into PackageDataDependencies
  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'CLARITY_CONCEPT',
    @i_sSourceColumnName = N'CONCEPT_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'CLARITY_CONCEPT',
    @i_sSourceColumnName = N'DATA_TYPE_C',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'ORDER_PROC',
    @i_sSourceColumnName = N'ORDER_PROC_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'CONTEXT_NAME',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'ELEMENT_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'HLV_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'RECORD_ID_NUMERIC',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'SMRTDTA_ELEM_VALUE',
    @i_sSourceColumnName = N'HLV_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'DateValue',
    @i_sSourceTableName = N'CLARITY_CONCEPT',
    @i_sSourceColumnName = N'DATA_TYPE_C',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'Value',
    @i_sSourceTableName = N'CLARITY_CONCEPT',
    @i_sSourceColumnName = N'DATA_TYPE_C',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'CLARITY_CONCEPT',
    @i_sSourceColumnName = N'CONCEPT_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'CLARITY_CONCEPT',
    @i_sSourceColumnName = N'DATA_TYPE_C',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'ORDER_PROC',
    @i_sSourceColumnName = N'ORDER_PROC_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'CONTEXT_NAME',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'ELEMENT_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'HLV_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'RECORD_ID_NUMERIC',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataDependencies
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'',
    @i_sSourceTableName = N'SMRTDTA_ELEM_VALUE',
    @i_sSourceColumnName = N'HLV_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.PreInsertIntoPackageDataSources @i_EpicReleased = @EpicReleased

  -- Insert into PackageDataSources
  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'AttributeId',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'ELEMENT_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'Date',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'CUR_VALUE_DATETIME',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'DateValue',
    @i_sSourceTableName = N'SMRTDTA_ELEM_VALUE',
    @i_sSourceColumnName = N'SMRTDTA_ELEM_VALUE',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'Id',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'HLV_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'Id',
    @i_sSourceTableName = N'SMRTDTA_ELEM_VALUE',
    @i_sSourceColumnName = N'LINE',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'NumericBaseId',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'HLV_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'ProcedureOrderId',
    @i_sSourceTableName = N'ORDER_PROC',
    @i_sSourceColumnName = N'ORDER_PROC_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sColumnName = N'Value',
    @i_sSourceTableName = N'SMRTDTA_ELEM_VALUE',
    @i_sSourceColumnName = N'SMRTDTA_ELEM_VALUE',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'AttributeId',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'ELEMENT_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'Date',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'CUR_VALUE_DATETIME',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'Id',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'HLV_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'Id',
    @i_sSourceTableName = N'SMRTDTA_ELEM_VALUE',
    @i_sSourceColumnName = N'LINE',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'NumericBaseId',
    @i_sSourceTableName = N'SMRTDTA_ELEM_DATA',
    @i_sSourceColumnName = N'HLV_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'NumericValue',
    @i_sSourceTableName = N'SMRTDTA_ELEM_VALUE',
    @i_sSourceColumnName = N'SMRTDTA_ELEM_VALUE',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'ProcedureOrderId',
    @i_sSourceTableName = N'ORDER_PROC',
    @i_sSourceColumnName = N'ORDER_PROC_ID',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.InsertIntoPackageDataSources
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sColumnName = N'Value',
    @i_sSourceTableName = N'SMRTDTA_ELEM_VALUE',
    @i_sSourceColumnName = N'SMRTDTA_ELEM_VALUE',
    @i_EpicReleased = 0,
    @i_IsAutomaticallyGenerated = 1

  EXECUTE Console.PreInsertIntoPackageIdTypes @i_EpicReleased = @EpicReleased

  -- Insert into PackageIdTypes
  EXECUTE Console.InsertIntoPackageIdTypes
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_Date_Load_X',
    @i_sIdType = N'EpicConceptValueID|line',
    @i_sDescription = N'Epic SmartData Element Value and corresponding line'

  EXECUTE Console.InsertIntoPackageIdTypes
    @i_sTableEtlName = N'ProcedureOrderAttributeValueDim',
    @i_sPackageName = N'Procedure_Order_Attribute_String_Load_X',
    @i_sIdType = N'EpicConceptValueID|line',
    @i_sDescription = N'Epic SmartData Element Value and associated line'

  EXECUTE Console.PostInsertIntoPackageIdTypes @sDmcName

  EXECUTE Console.PreInsertIntoPackageVariables @i_EpicReleased = @EpicReleased

  -- Insert into PackageVariables
  --    No data   

  EXECUTE Console.PostInsertIntoPackageVariables

  EXECUTE Console.PreInsertIntoPackageQueryExtensions

  -- Insert into PackageQueryExtensions
  --    No data   

  EXECUTE Console.PreInsertIntoProcedureEtls @sDmcName, @EpicReleased

  -- Insert into ProcedureEtls
  --    No data   

  EXECUTE Console.PostInsertIntoProcedureEtls

  EXECUTE Console.PreInsertIntoTableEtls @sDmcName, @EpicReleased

  -- Insert into TableEtls
  --    No data   

  EXECUTE Console.PreInsertIntoTableEtlColumns @sDmcName, @EpicReleased

  -- Insert into TableEtlColumns
  --    No data   

  EXECUTE Console.PostInsertIntoTableEtlColumns @sDmcName

  EXECUTE Console.PreInsertIntoDmcPartitionInfo @sDmcName

  -- Insert into DmcPartitionInfo
  --    No data   

  EXECUTE Console.PostInsertIntoDmcPartitionInfo @sDmcName

  EXECUTE Console.PreInsertIntoTableEtlIndexes @sDmcName, @EpicReleased

  -- Insert into TableEtlIndexes
  --    No data   

  EXECUTE Console.PreInsertIntoWarehouseTables @sDmcName, @EpicReleased

  -- Insert into WarehouseTables
  --    No data   

  EXECUTE Console.PostInsertIntoWarehouseTables @sDmcName, @EpicReleased

  EXECUTE Console.PreInsertIntoOrganizationFilter @sDmcName, @EpicReleased

  -- Insert into OrganizationFilter
  EXECUTE Console.InsertIntoOrganizationFilter
    @i_sDmcName = N'ProcedureOrderAttributeValueDim',
    @i_sReleasedFilterType = N'Patient',
    @i_xReleasedJoinPath = N'<JoinPath FilterType="Patient" FinalDmc="ProcedureOrderFact" FinalColumn="PatientDurableKey"><Join JoinCount="1" BridgeJoin="0" Type2Join="0"><ToDmc>ProcedureOrderFact</ToDmc><ToColumn>ProcedureOrderKey</ToColumn><FromDmc>ProcedureOrderAttributeValueDim</FromDmc><FromColumn>ProcedureOrderKey</FromColumn></Join></JoinPath>',
    @i_sOverrideFilterType = NULL,
    @i_xOverrideJoinPath = NULL,
    @i_UseOverride = 0

  EXECUTE Console.PostInsertIntoOrganizationFilter @sDmcName, @EpicReleased

  EXECUTE Console.PreInsertIntoDmcDurationStartAndEndColumns @sDmcName, @EpicReleased

  -- Insert into DmcDurationStartAndEndColumns
  --    No data   

  EXECUTE Console.PostDmcScript @sDmcName, @EpicReleased, @HasDeveloperAccess, @ScriptType

  --************************************************************************
  -- PRE-CONVERSION
  -- This code will be executed before the script starts changing the reporting tables.
  -- Replace this comment with your code if needed.
  -- For example if you have renamed an existing column in the metadata, you may want to 
  -- add code to rename the column here otherwise the new column will be created and the
  -- old column will be renamed to column_old.
 
  -- EXECUTE <<insert Reporting Database>>..sp_rename 'dbo.ProcedureOrderAttributeValueDim.<<insert OldColumnName>>', '<<insert NewColumnName>>', 'COLUMN'
  --************************************************************************

  EXECUTE Console.CreateTablesInNonDev @sDmcName, @RemoveHistoricalRows

  --************************************************************************
  -- POST-CONVERSION
  -- This code will be executed after the script has changed the reporting tables.
  -- Replace this comment with your code if needed.
  -- For example if you have a column where the data type is changed in the metadata,
  -- the install script will rename the existing column to column_old. You should consider resetting 
  -- the backfill id if needed, add the code to move the data from column_old to column, 
  -- and drop column_old in a background job.

  -- Below are simple examples of actions that may be performed via post-conversion:

  --  Example One: Reset package backfills
  --  EXECUTE Epic.ResetBackfillLastId N'ProcedureOrderAttributeValueDim',
  --          N'<<insert PackageName>>' -- If package name is NULL, backfill id for all packages for ProcedureOrderAttributeValueDim are updated

  --  Example Two: Change column data type
  --  EXECUTE Epic.InsertJob N'Deferred conversion: Populate column ''<<insert ColumnName>>'' in the table ''ProcedureOrderAttributeValueDim'' ',
  --          N'<<insert logic to populate data and drop column_old>>',
  --          N'ProcedureOrderAttributeValueDim', NULL, NULL,
  --          N'<<insert Priority from Config.JobPriorities.Label>>'
  --************************************************************************

  -- Release the system level lock
  EXECUTE Epic.LockEtl N'System', 0, @i_sLockedBy = N'Console Generated Script', @i_IsExecution = 0

END TRY
BEGIN CATCH
  -- Release the system level lock
  EXECUTE Epic.LockEtl N'System', 0, @i_sLockedBy = N'Console Generated Script', @i_IsExecution = 0

  -- Throw the error message if any 
  ; THROW;

END CATCH


